# Azure pipeline that runs module integrate tests

trigger:
- none

pool:
  vmImage: 'ubuntu-latest'

  variables:
    imageName: 'pipeline-testrunner-docker'

  steps:
  - task: Docker@2
    displayName: Build an image
    inputs:
      repository: $(imageName)
      command: build
      Dockerfile: ../Dockerfile

  - task: Docker@2
    displayName: Push image
    input:
      containerRegistry:
        $(dockerHub)
      repository: $(imageName)
      command: push
      tags: |
        test1
        test2

# - stage: Build
#   displayName: Build and push stage
#   jobs:  
#   - job: Build
#     displayName: Build job
#     pool:
#       vmImage: $(vmImageName)
#     steps:
#     - task: Docker@2
#       displayName: Build and push an image to container registry
#       inputs:
#         command: buildAndPush
#         repository: $(imageRepository)
#         dockerfile: $(dockerfilePath)
#         containerRegistry: $(dockerRegistryServiceConnection)
#         tags: |
#           $(tag)